{
  "version": 3,
  "sources": ["../node_modules/@webqit/util/js/isObject.js", "../node_modules/@webqit/util/js/isArray.js", "../node_modules/@webqit/util/arr/intersect.js", "../node_modules/@webqit/util/js/internals.js", "../node_modules/@webqit/util/js/isTypeFunction.js", "../node_modules/@webqit/util/js/isNull.js", "../node_modules/@webqit/util/js/isUndefined.js", "../node_modules/@webqit/util/js/isTypeObject.js", "../node_modules/@webqit/util/js/isEmpty.js", "../node_modules/@webqit/util/js/isFunction.js", "../node_modules/@webqit/util/js/isNumber.js", "../node_modules/@webqit/util/js/isNumeric.js", "../node_modules/@webqit/util/js/isString.js", "../node_modules/@webqit/util/js/isTypeArray.js", "../node_modules/@webqit/util/arr/from.js", "../node_modules/@webqit/util/obj/get.js", "../node_modules/@webqit/util/obj/set.js", "../src/Scheduler.js", "../src/realtime/Realtime.js", "../src/realtime/ATTRRealtime.js", "../src/realtime/DOMRealtime.js", "../src/polyfills.js", "../src/index.js", "../src/targets.browser.js"],
  "sourcesContent": ["\r\n/**\r\n * Tells if val is pure object.\r\n *\r\n * @param object\t \tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn !Array.isArray(val) && typeof val === 'object' && val;\r\n};\r\n", "\r\n/**\r\n * Tells if val is of type \"array\".\r\n *\r\n * @param object\t \tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn Array.isArray(val);\r\n};\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport _isArray from '../js/isArray.js';\r\n\r\n/**\r\n * Returns the intersection of two arrays;\r\n * optionally using a custom matching function.\r\n *\r\n * @param array \tarr\r\n * @param array\t \tarr2\r\n * @param function \tcallback\r\n *\r\n * @return array\r\n */\r\nexport default function(arr, arr2, callback = null) {\r\n\treturn !_isArray(arr2) ? [] : arr.filter(val1 => callback \r\n\t\t? arr2.filter(val2 => callback(val1, val2)).length \r\n\t\t: arr2.indexOf(val1) !== -1\r\n\t);\r\n};\r\n", "/**\r\n * @imports\r\n */\r\nimport _intersect from '../arr/intersect.js';\r\n\r\n/**\r\n * Creates and/or returns an \"internals\" object for the given object.\r\n * \r\n * @param Any obj\r\n * @param String namespace\r\n * \r\n * @return Object\r\n */\r\nexport default function internals(obj, ...namespaces) {\r\n    if (!globalThis.webqit) { globalThis.webqit = {}; }\r\n    if (!globalThis.webqit.refs) {\r\n        Object.defineProperty(globalThis.webqit, 'refs', {value: new ObservableMap})\r\n    }\r\n    if (!arguments.length) return globalThis.webqit.refs;\r\n    let itnls = globalThis.webqit.refs.get(obj);\r\n    if (!itnls) {\r\n        itnls = new ObservableMap;\r\n        globalThis.webqit.refs.set(obj, itnls);\r\n    }\r\n    let _ns, _itnls;\r\n    while ((_ns = namespaces.shift())) {\r\n        if ((_itnls = itnls) && !(itnls = itnls.get(_ns))) {\r\n            itnls = new ObservableMap;\r\n            _itnls.set(_ns, itnls);\r\n        }\r\n    }\r\n    return itnls;\r\n}\r\n\r\nclass ObservableMap extends Map {\r\n    constructor( ...args ) {\r\n        super( ...args );\r\n        this.observers = new Set;\r\n    }\r\n    set( key, value ) {\r\n        let returnValue = super.set( key, value );\r\n        this.fire( 'set', key, value, key );\r\n        return returnValue;\r\n    }\r\n    delete( key ) {\r\n        let returnValue = super.delete( key );\r\n        this.fire( 'delete', key );\r\n        return returnValue;\r\n    }\r\n    has( key ) {\r\n        this.fire( 'has', key );\r\n        return super.has( key );\r\n    }\r\n    get( key ) {\r\n        this.fire( 'get', key );\r\n        return super.get( key );\r\n    }\r\n    keyNames() { return Array.from( super.keys() ); }\r\n    observe( type, key, callback ) {\r\n        const entry = { type, key, callback };\r\n        this.observers.add( entry );\r\n        return () => this.observers.delete( entry );\r\n    }\r\n    unobserve( type, key, callback ) {\r\n        if ( Array.isArray( type ) || Array.isArray( key ) ) {\r\n            throw new Error( `The \"type\" and \"key\" arguments can only be strings.` );\r\n        }\r\n        for ( let entry of this.observers ) {\r\n            if ( !( _intersection( [ type, '*' ], entry.type ) && _intersection( [ key, '*' ], entry.key ) && entry.callback === callback ) ) continue;\r\n            this.observers.delete( entry );\r\n        }\r\n    }\r\n    fire( type, key, ...args ) {\r\n        // IMPORTANT: Array.from() must be used so that new additions to this.observers\r\n        // during the loop aren't picked up!\r\n        for ( let entry of this.observers ) {\r\n            if ( !( _intersection( [ type, '*' ], entry.type ) && _intersection( [ key, '*' ], entry.key ) ) ) continue;\r\n            entry.callback( ...args );\r\n        }\r\n    }\r\n}\r\n\r\nconst _intersection = ( a, b ) => {\r\n    if ( Array.isArray( b ) ) return _intersect( a, b ).length;\r\n    return a.includes( b );\r\n}\r\n", "\r\n/**\r\n * Tells if val is of type \"function\".\r\n * This holds true for both regular functions and classes.\r\n *\r\n * @param object\t \tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn typeof val === 'function';\r\n};\r\n", "\r\n/**\r\n * Tells if val is undefined or is null.\r\n *\r\n * @param string \tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn val === null || val === '';\r\n};\r\n", "\r\n/**\r\n * Tells if val is undefined or is of type \"undefined\".\r\n *\r\n * @param string \tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn arguments.length && (val === undefined || typeof val === 'undefined');\r\n};\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport _isTypeFunction from './isTypeFunction.js';\r\n\r\n/**\r\n * Tells if val is of type \"object\".\r\n * This holds true for anything object, including built-ins.\r\n *\r\n * @param object\t \tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn Array.isArray(val) || (typeof val === 'object' && val) || _isTypeFunction(val);\r\n};\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport _isNull from './isNull.js';\r\nimport _isUndefined from './isUndefined.js';\r\nimport _isTypeObject from './isTypeObject.js';\r\n\r\n/**\r\n * Tells if val is empty in its own type.\r\n * This holds true for NULLs, UNDEFINED, FALSE, 0,\r\n * objects without keys, empty arrays.\r\n *\r\n * @param string \tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn _isNull(val) || _isUndefined(val) || val === false || val === 0 \r\n\t\t|| (_isTypeObject(val) && !Object.keys(val).length);\r\n};\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport _isTypeFunction from './isTypeFunction.js';\r\n\r\n/**\r\n * Tells if val is of type \"function\".\r\n *\r\n * @param object \t\tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn _isTypeFunction(val) || (val && {}.toString.call(val) === '[object function]');\r\n};\r\n", "\r\n/**\r\n * Tells if val is of type \"number\".\r\n *\r\n * @param string \tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn val instanceof Number || (typeof val === 'number');\r\n};\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport _isNumber from './isNumber.js';\r\n/**\r\n * Tells if val is of type \"string\" or a numeric string.\r\n * This holds true for both numbers and numeric strings.\r\n *\r\n * @param string \tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn _isNumber(val) || (val !== true && val !== false && val !== null && val !== '' && !isNaN(val * 1));\r\n};\r\n", "\r\n/**\r\n * Tells if val is of type \"string\".\r\n *\r\n * @param string \tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn val instanceof String || (typeof val === 'string' && val !== null);\r\n};\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport _isString from './isString.js';\r\nimport _isUndefined from './isUndefined.js';\r\n\r\n/**\r\n * Tells if val is \"array-like\".\r\n * This holds true for anything that has a length property.\r\n *\r\n * @param object\t \tval\r\n *\r\n * @return bool\r\n */\r\nexport default function(val) {\r\n\treturn !_isString(val) && !_isUndefined(val.length);\r\n};\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport _isArray from '../js/isArray.js';\r\nimport _isTypeArray from '../js/isTypeArray.js';\r\nimport _isEmpty from '../js/isEmpty.js';\r\nimport _isObject from '../js/isObject.js';\r\n\r\n/**\r\n * Casts an array-like object to an array.\r\n *\r\n * @param mixed \tval\r\n * @param bool\t \tcastObject\r\n *\r\n * @return array\r\n */\r\nexport default function(val, castObject = true) {\r\n\tif (_isArray(val)) {\r\n\t\treturn val;\r\n\t};\r\n\tif (!castObject && _isObject(val)) {\r\n\t\treturn [val];\r\n\t};\r\n\tif (val !== false && val !== 0 && _isEmpty(val)) {\r\n\t\treturn [];\r\n\t};\r\n\tif (_isTypeArray(val)) {\r\n\t\treturn Array.prototype.slice.call(val);\r\n\t};\r\n\tif (_isObject(val)) {\r\n\t\treturn Object.values(val);\r\n\t};\r\n\treturn [val];\r\n};\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport _isTypeObject from '../js/isTypeObject.js';\r\nimport _isUndefined from '../js/isUndefined.js';\r\nimport _isNull from '../js/isNull.js';\r\nimport _arrFrom from '../arr/from.js';\r\n\r\n/**\r\n * Retrieves the value at the given path.\r\n *\r\n * A return value of undefined is ambiguous, and can mean either that the\r\n * path does not exist, or that the path actually exists but with a value of undefined. If it is required to\r\n * know whether the path actually exists, pass an object as a third argument.\r\n * This object will have an \"exists\" key set to true/false.\r\n *\r\n * @param object \t\t\t\tctxt\r\n * @param array \t\t\t\tpath\r\n * @param object \t\t\t\ttrap\r\n * @param object \t\t\t\treciever\r\n *\r\n * @return mixed\r\n */\r\nexport default function(ctxt, path, trap = {}, reciever = {}) {\r\n\tpath = _arrFrom(path).slice();\r\n\tvar _ctxt = ctxt;\r\n\twhile(!_isUndefined(_ctxt) && !_isNull(_ctxt) && path.length) {\r\n\t\tvar _key = path.shift();\r\n\t\tif (!(trap.get ? trap.get(_ctxt, _key) : (_isTypeObject(_ctxt) ? _key in _ctxt : _ctxt[_key]))) {\r\n\t\t\treciever.exists = false;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t_ctxt = trap.get ? trap.get(_ctxt, _key) : _ctxt[_key];\r\n\t}\r\n\treciever.exists = true;\r\n\treturn _ctxt;\r\n};\r\n", "\r\n/**\r\n * @imports\r\n */\r\nimport _isTypeObject from '../js/isTypeObject.js';\r\nimport _isFunction from '../js/isFunction.js';\r\nimport _isNumeric from '../js/isNumeric.js';\r\nimport _isArray from '../js/isArray.js';\r\nimport _arrFrom from '../arr/from.js';\r\nimport _get from './get.js';\r\n\r\n/**\r\n * Sets a value to the given path.\r\n *\r\n * @param object \t\t\t\tobj\r\n * @param array \t\t\t\tpath\r\n * @param mixed \t\t\t\tval\r\n * @param object|function \t\tbuildTree\r\n * @param object \t\t\t\ttrap\r\n *\r\n * @return bool\r\n */\r\nexport default function(obj, path, val, buildTree = {}, trap = {}) {\r\n\tconst _set = (target, key, val) => {\r\n\t\tif (trap.set) {\r\n\t\t\treturn trap.set(target, key, val);\r\n\t\t} else {\r\n\t\t\tif (_isNumeric(path[i]) && _isArray(target)) {\r\n\t\t\t\ttarget.push(val);\r\n\t\t\t} else {\r\n\t\t\t\ttarget[key] = val;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\t};\r\n\tpath = _arrFrom(path);\r\n\tvar target = obj;\r\n\tfor(var i = 0; i < path.length; i ++) {\r\n\t\tif (i < path.length - 1) {\r\n\t\t\tif (!target || (!_isTypeObject(target) && !_isFunction(target))) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tvar branch = _get(target, path[i], trap);\r\n\t\t\tif (!_isTypeObject(branch)) {\r\n\t\t\t\tif (trap.buildTree === false) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tbranch = _isFunction(trap.buildTree) ? trap.buildTree(i) : (_isNumeric(path[i + 1]) ? [] : {});\r\n\t\t\t\tvar branchSuccess = _set(target, path[i], branch);\r\n\t\t\t\tif (!branchSuccess) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\ttarget = branch;\r\n\t\t} else {\r\n\t\t\treturn _set(target, path[i], val);\r\n\t\t}\r\n\t}\r\n};\r\n", "\n/**\n * ---------------------------\n * Binds callbacks to requestAnimationFrame()\n * to create a central \"read/write\" phases for Ctxt access.\n * ---------------------------\n */\n\t\t\t\nexport default class Scheduler {\n\n\t/**\n\t * Starts the loop.\n\t *\n\t * @return this\n\t */\n\tconstructor( window, asyncDOM = true ) {\n\t\tObject.defineProperty( this, 'window', { value: window } );\n\t\tObject.defineProperty( this, 'readCallbacks', { value: new Set } );\n\t\tObject.defineProperty( this, 'writeCallbacks', { value: new Set } );\n\t\tthis.async = asyncDOM;\n\t\tif ( this.window.requestAnimationFrame ) {\n\t\t\tthis._run();\n\t\t} else {\n\t\t\tthis.async = false;\n\t\t}\n\t}\n\n\t_run() {\n\t\tthis.window.requestAnimationFrame( () => {\n\t\t\tfor ( const callback of this.readCallbacks ) {\n\t\t\t\tcallback();\n\t\t\t\tthis.readCallbacks.delete( callback );\n\t\t\t}\n\t\t\tfor ( const callback of this.writeCallbacks ) {\n\t\t\t\tcallback();\n\t\t\t\tthis.writeCallbacks.delete( callback );\n\t\t\t}\n\t\t\tthis._run();\n\t\t} );\n\t}\n\t\n\t/**\n\t * Binds a callback to the \"read\" phase.\n\t *\n\t * @param function \tcallback\n\t * @param bool\t\twithPromise\n\t *\n\t * @return void\n\t */\n\tonread( callback, withPromise = false ) {\n\t\tif ( withPromise ) {\n\t\t\treturn new Promise( resolve => {\n\t\t\t\tif ( this.async === false ) {\n\t\t\t\t\tresolve( callback() );\n\t\t\t\t} else {\n\t\t\t\t\tthis.readCallbacks.add( () => {\n\t\t\t\t\t\tresolve( callback() );\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t\tif ( this.async === false ) {\n\t\t\tcallback();\n\t\t} else {\n\t\t\tthis.readCallbacks.add( callback );\n\t\t}\n\t}\n\t\n\t/**\n\t * Binds a callback to the \"write\" phase.\n\t *\n\t * @param function \tcallback\n\t * @param bool\t\twithPromise\n\t *\n\t * @return void\n\t */\n\tonwrite( callback, withPromise = false ) {\n\t\tif ( withPromise ) {\n\t\t\treturn new Promise( resolve => {\n\t\t\t\tif ( this.async === false ) {\n\t\t\t\t\tresolve( callback() );\n\t\t\t\t} else {\n\t\t\t\t\tthis.writeCallbacks.add( () => {\n\t\t\t\t\t\tresolve( callback() );\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t\tif ( this.async === false ) {\n\t\t\tcallback();\n\t\t} else {\n\t\t\tthis.writeCallbacks.add( callback );\n\t\t}\n\t}\n\t\n\t/**\n\t * A special construct for Ctxt manipulations that span\n\t * one or more read/write cycles.\n\t *\n\t * @param function \tread\n\t * @param function \twrite\n\t * @param mixed\t\tprevTransaction\n\t *\n\t * @return void|mixed\n\t */\n\tcycle( onread, onwrite, prevTransaction ) {\n\t\tthis.onread( () => {\n\t\t\t// Record initial values\n\t\t\tconst readReturn = onread( prevTransaction );\n\t\t\t// Call erite, the transation\n\t\t\tconst callWrite = ( readReturn ) => {\n\t\t\t\tif ( readReturn === undefined ) return;\n\t\t\t\tthis.onwrite( () => {\n\t\t\t\t\tconst writeReturn = onwrite( readReturn, prevTransaction );\n\t\t\t\t\t// Repeat transaction\n\t\t\t\t\tconst repeatTransaction = ( writeReturn ) => {\n\t\t\t\t\t\tif ( writeReturn === undefined ) return;\n\t\t\t\t\t\tthis.cycle( onread, onwrite, writeReturn );\n\t\t\t\t\t};\n\t\t\t\t\t// ---------------------------------------\n\t\t\t\t\t// If \"write\" returns a promise, we wait until it is resolved\n\t\t\t\t\t// ---------------------------------------\n\t\t\t\t\tif ( writeReturn instanceof Promise ) {\n\t\t\t\t\t\twriteReturn.then( repeatTransaction );\n\t\t\t\t\t} else {\n\t\t\t\t\t\trepeatTransaction( writeReturn );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t};\n\t\t\t// ---------------------------------------\n\t\t\t// If \"read\" returns a promise, we wait until it is resolved\n\t\t\t// ---------------------------------------\n\t\t\tif ( readReturn instanceof Promise ) {\n\t\t\t\treadReturn.then( callWrite );\n\t\t\t} else {\n\t\t\t\tcallWrite( readReturn );\n\t\t\t}\n\t\t} );\n\t}\n\n}", "\n/**\n * @imports\n */\nimport { _isFunction, _isObject, _internals } from '@webqit/util/js/index.js';\nimport { _from as _arrFrom } from '@webqit/util/arr/index.js';\n\n/**\n *\n * @class Realtime\n */\nexport default class Realtime {\n\n\t/**\n\t * @constructor\n\t *\n\t * @param document|Element\tcontext\n\t */\n\tconstructor( context, namespace, window ) {\n\t\tthis.context = context;\n\t\tthis.namespace = namespace;\n\t\tthis.window = context.defaultView || context.ownerDocument?.defaultView || window;\n\t\tthis.document = this.window.document;\n\t\tthis.webqit = this.window.webqit;\n\t\tObject.defineProperty( this, '#', { value: {} } );\n\t}\n\n\t/**\n\t * Resolves arguments\n\t * \n\t * @param Array \t\t\targs \n\t * \n\t * @returns Array\n\t */\n\tresolveArgs( args ) {\n\t\tif ( _isFunction( args[ 0 ] ) ) { args = [ [], ...args ]; }\n\t\telse if ( _isObject( args[ 0 ] ) && args.length === 1 ) {\n\t\t\targs = [ [], undefined, args[ 0 ] ];\n\t\t} else if ( _isObject( args[ 1 ] ) && args.length === 2 ) {\n\t\t\targs = [ _arrFrom( args[ 0 ], false/*castObject*/ ), undefined, args[ 1 ] ];\n\t\t} else { args[ 0 ] = _arrFrom( args[ 0 ], false/*castObject*/ ); }\n\t\treturn args;\n\t}\n\n\t/**\n\t * @registry\n\t *\n\t * @param Array\t\t\t\t...args\n\t * \n\t * @returns Map\n\t */\n\tregistry( ...args ) {\n\t\treturn _internals( 'realdom.realtime', this.window, this.namespace, ...args );\n\t}\n\t\t\n\t/**\n\t * @createSignalGenerator\n\t * \n\t * @param Object \t\t\tmo \n\t * \n\t * @returns Object\n\t */\n\tcreateSignalGenerator() {\n\t\treturn {\n\t\t\tgenerate() {\n\t\t\t\t// Abort previous\n\t\t\t\tthis.lastController?.abort();\n\t\t\t\tthis.lastController = new AbortController;\n\t\t\t\tconst flags = { signal: this.lastController.signal };\n\t\t\t\treturn flags;\n\t\t\t},\n\t\t\tdisconnect() { this.lastController?.abort(); }\n\t\t}\n\t}\n\t\t\n\t/**\n\t * Loops through registration objects whose contexts match the event context.\n\t * \n\t * @param String \t\tinterceptionTiming\n\t * @param Object|Array \trecord_s\n\t * @param Function \t\tcallback \n\t * \n\t * @returns void\n\t */\n\tforEachMatchingContext( interceptionTiming, record_s, callback ) {\n\t\tconst { window } = this, records = Array.isArray( record_s ) ? record_s : [ record_s ];\n\t\tlet dispatchBatch = new Set;\n\t\tfor ( const [ depth, registries ] of this.registry( interceptionTiming ) ) {\n\t\t\tfor ( const [ context, registry ] of registries ) {\n\t\t\t\t// Ensure event target is/within context\n\t\t\t\tlet matches = records.filter( record => {\n\t\t\t\t\tif ( !context.contains( record.target ) ) return false;\n\t\t\t\t\treturn depth === 'subtree' || record.target === context;\n\t\t\t\t} );\n\t\t\t\tif ( !matches.length ) continue;\n\t\t\t\t// Records will be dispatched in their original form\n\t\t\t\tif ( !Array.isArray( record_s ) ) { matches = matches[ 0 ]; }\n\t\t\t\tfor ( const registration of registry ) {\n\t\t\t\t\tdispatchBatch.add( [ registration, matches, context ] );\n\t\t\t\t\t//callback.call( this, registration, matches, context );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// Saving everything to dispatchBatch ensures that recursive modifications\n\t\t// to both this.registry( interceptionTiming ), registries, and registry aren't pciked up\n\t\tfor ( const [ registration, record_s, context ] of dispatchBatch ) {\n\t\t\tcallback.call( this, registration, record_s, context );\n\t\t}\n\t}\n\n\t/**\n\t * @disconnectables\n\t * \n\t * @param AbortSignal \t\tsignal\n\t * @param Array \t\t\t...objects \n\t * \n\t * @returns Object\n\t */\n\tdisconnectables( signal, ...objects ) {\n\t\tconst disconnectable = { disconnect() {\n\t\t\tobjects.forEach( d => (\n\t\t\t\td && _isFunction( d.disconnect ) && d.disconnect() \n\t\t\t\t|| _isFunction( d ) && d() \n\t\t\t\t|| _isObject( d ) && ( d.disconnected = true )\n\t\t\t) );\n\t\t} };\n\t\tif ( signal ) signal.addEventListener( 'abort', () => disconnectable.disconnect() );\n\t\treturn disconnectable;\n\t}\n}\n", "\n/**\n * @imports\n */\nimport Realtime from './Realtime.js';\n\n/**\n *\n * @class AttrRealtime\n */\nexport default class AttrRealtime extends Realtime {\n\n\t/**\n\t * @constructor\n\t */\n\tconstructor( context, ...args ) {\n\t\tsuper( context, 'attr', ...args );\n\t}\n\t\n\t/**\n\t * Runs a query.\n\t *\n\t * @param array|string\t\t\t\tfilter\n\t * @param function\t\t\t\t\tcallback\n\t * @param object\t\t\t\t\tparams\n\t *\n\t * @return Disconnectable|Void\n\t */\n\tget( filter, callback = undefined, params = {} ) {\n\t\tconst originalFilterIsString = typeof filter === 'string';\n\t\t[ filter = [], callback = undefined, params = {} ] = this.resolveArgs( arguments );\n\t\tconst { context } = this;\n\t\t// -------------\n\t\tconst records = attrIntersection( context, filter );\n\t\tconst record_s = originalFilterIsString ? records[ 0 ] : records;\n\t\tif ( !callback ) return record_s;\n\t\tconst signalGenerator = callback && params.lifecycleSignals && this.createSignalGenerator();\n\t\tconst flags = signalGenerator?.generate() || {};\n\t\tcallback( record_s, flags, context );\n\t\t// -------------\n\t\tif ( params.live ) {\n\t\t\tif ( signalGenerator ) { params = { ...params, signalGenerator }; }\n\t\t\tconst disconnectable_live = this.observe( originalFilterIsString ? filter[ 0 ] : filter, callback, { newValue: true, ...params } );\n\t\t\treturn this.disconnectables( params.signal, disconnectable_live );\n\t\t}\n\t}\n\n\t/**\n\t * Mutation Observer\n\t * \n\t * @param array|string\t\t\t\tfilter\n\t * @param function\t\t\t\t\tcallback\n\t * @param object\t\t\t\t\tparams\n\t * \n\t * @returns Disconnectable\n\t */\n\tobserve( filter, callback, params = {} ) {\n\t\tconst originalFilterIsString = typeof filter === 'string';\n\t\t[ filter = [], callback, params = {} ] = this.resolveArgs( arguments );\n\t\t// ------------------------\n\t\tif ( [ 'sync', 'intercept' ].includes( params.timing ) ) return this.observeSync( originalFilterIsString ? filter[ 0 ] : filter, callback, params );\n\t\tif ( params.timing && params.timing !== 'async' ) throw new Error( `Timing option \"${ params.timing }\" invalid.` );\n\t\t// ------------------------\n\t\tconst { context, window, webqit } = this;\n\t\t// ------------------\n\t\tif ( params.eventDetails && !webqit.realdom.attrInterceptionHooks?.intercepting ) {\n\t\t\tattrInterception.call( window, 'intercept', () => {} );\n\t\t}\n\t\t// -------------\n\t\tconst disconnectable = new window.MutationObserver( records => {\n\t\t\trecords = dedup( records ).map( rcd => withAttrEventDetails.call( window, rcd ) );\n\t\t\tdispatch.call( window, registration, records, context );\n\t\t} );\n\t\t// ------------------\n\t\tconst $params = { attributes: true, attributeOldValue: params.oldValue, subtree: params.subtree };\n\t\tif ( filter.length ) { $params.attributeFilter = filter; }\n\t\tdisconnectable.observe( context, $params );\n\t\t// -------------\n\t\tconst signalGenerator = params.signalGenerator || params.lifecycleSignals && this.createSignalGenerator();\n\t\tconst registration = { context, filter, callback, params, atomics: new Map, originalFilterIsString, signalGenerator, disconnectable };\n\t\t// -------------\n\t\treturn this.disconnectables( params.signal, disconnectable, signalGenerator );\n\t}\n\t\n\t/**\n\t * Mutation Interceptor\n\t * \n\t * @param array|string\t\t\t\tfilter\n\t * @param function\t\t\t\t\tcallback\n\t * @param object\t\t\t\t\tparams\n\t * \n\t * @returns Disconnectable\n\t */\n\tobserveSync( filter, callback, params = {} ) {\n\t\tconst originalFilterIsString = typeof filter === 'string';\n\t\t[ filter, callback, params = {} ] = this.resolveArgs( arguments );\n\t\tconst { context, window } = this;\n\t\t// -------------\n\t\tif ( params.timing && ![ 'sync', 'intercept' ].includes( params.timing ) ) throw new Error( `Timing option \"${ params.timing }\" invalid.` );\n\t\tconst interceptionTiming = params.timing === 'intercept' ? 'intercept' : 'sync';\n\t\tconst intersectionDepth = params.subtree ? 'subtree' : 'children';\n\t\tif ( !this.registry( interceptionTiming ).size ) {\n\t\t\t// One handler per intercept/sync registry\n\t\t\tattrInterception.call( window, interceptionTiming, records => {\n\t\t\t\tthis.forEachMatchingContext( interceptionTiming, records, dispatch );\n\t\t\t} );\n\t\t}\n\t\t// -------------\n\t\tconst disconnectable = { disconnect() {\n\t\t\tregistry.delete( registration );\n\t\t\tif ( !registry.size ) { registries.delete( context ); }\n\t\t} };\n\t\tconst signalGenerator = params.signalGenerator || params.lifecycleSignals && this.createSignalGenerator();\n\t\tconst registration = { context, filter, callback, params, atomics: new Map, originalFilterIsString, signalGenerator, disconnectable };\n\t\t// -------------\n\t\tconst registries = this.registry( interceptionTiming, intersectionDepth );\n\t\tif ( !registries.has( context ) ) { registries.set( context, new Set ); }\n\t\tconst registry = registries.get( context );\n\t\tregistry.add( registration );\n\t\t// -------------\n\t\treturn this.disconnectables( params.signal, disconnectable, signalGenerator );\n\t}\n}\n\n/**\n * Deduplicates records.\n * \n * @param Array \t\t\trecords\n * \n * @returns Array\n */\nfunction dedup( records ) {\n\treturn records.reduce( ( rcds, rcd, i ) => {\n\t\tif ( rcds[ i - 1 ]?.attributeName === rcd.attributeName ) return rcds;\n\t\treturn rcds.concat( rcd );\n\t}, [] );\n}\n\n/**\n * Dispatches a mutation record if it matches the observed.\n * \n * @param Object \t\t\tregistration\n * @param Array \t\t\trecords\n * \n * @returns Void\n */\nfunction dispatch( registration, records ) {\n\tconst { context, filter, callback, params, atomics, originalFilterIsString, signalGenerator } = registration;\n\tif ( params.atomic && !atomics.size ) {\n\t\trecords = attrIntersection( context, filter, records );\n\t}\n\t// Should we care about old / new values being present?\n\tif ( !( params.newValue === null && params.oldValue === null && params.eventDetails ) ) {\n\t\trecords = records.map( rcd => {\n\t\t\tlet exclusion;\n\t\t\tif ( !params.eventDetails ) {\n\t\t\t\t( { event: exclusion, ...rcd } = rcd );\n\t\t\t}\n\t\t\tif ( !params.oldValue && ( 'oldValue' in rcd ) ) {\n\t\t\t\t( { oldValue: exclusion, ...rcd } = rcd );\n\t\t\t}\n\t\t\tif ( !params.newValue && ( 'value' in rcd ) ) {\n\t\t\t\t( { value: exclusion, ...rcd } = rcd );\n\t\t\t} else if ( params.newValue && typeof rcd.value === 'undefined' ) {\n\t\t\t\trcd = {  ...rcd, value: rcd.target.getAttribute( rcd.name ) };\n\t\t\t}\n\t\t\treturn rcd;\n\t\t} );\n\t}\n\tif ( params.atomic ) {\n\t\trecords.forEach( record => atomics.set( record.name, record ) );\n\t\trecords = Array.from( atomics.entries() ).map( ( [ , value ] ) => value );\n\t}\n\tconst record_s = originalFilterIsString ? records[ 0 ] : records;\n\tconst flags = signalGenerator?.generate() || {};\n\tcallback( record_s, flags, context );\n}\n\n/**\n * Helper to determining which records to deliver.\n * \n * @param Object \t\t\tcontext\n * @param Array \t\t\tfilter\n * @param Array \t\t\trecords\n * \n * @returns Array\n */\nfunction attrIntersection( context, filter, records = [] ) {\n\tconst _type = { event: null, type: 'attribute' };\n\tif ( filter.length ) {\n\t\treturn filter.map( attrName => {\n\t\t\treturn records.find( r => r.name === attrName ) || { target: context, name: attrName, value: context.getAttribute( attrName ), ..._type };\n\t\t} );\n\t}\n\tconst attrs = Array.from( context.attributes );\n\treturn attrs.map( attr => {\n\t\treturn records.find( r => r.name === attr.nodeName ) || { target: context, name: attr.nodeName, value: attr.nodeValue, ..._type };\n\t} );\n}\n\n/**\n * Determines the event for an attr mutation record.\n * \n * @param MutationRecord \t{ target, attributeName }\n * \n * @returns Object\n */\nfunction withAttrEventDetails( { target, attributeName, value, oldValue } ) {\n\tconst window = this, registry = window.webqit.realdom.attrInterceptionRecords?.get( target ) || {};\n\tconst event = registry[ attributeName ] || 'mutation';\n\tconst record = { target, name: attributeName, value, oldValue, type: 'observation', event };\n\treturn record;\n}\n\n/**\n * Attributes intersection engine.\n * \n * @param String \t\t\ttiming \n * @param Function \t\t\tcallback \n * \n * @returns \n */\nfunction attrInterception( timing, callback ) {\n\tconst window = this;\n\tconst { webqit, document, Element } = window;\n\tif ( !webqit.realdom.attrInterceptionHooks ) { Object.defineProperty( webqit.realdom, 'attrInterceptionHooks', { value: new Map } ); }\n\tif ( !webqit.realdom.attrInterceptionHooks.has( timing ) ) { webqit.realdom.attrInterceptionHooks.set( timing, new Set ); }\n\twebqit.realdom.attrInterceptionHooks.get( timing ).add( callback );\n\tconst rm = () => webqit.realdom.attrInterceptionHooks.get( timing ).delete( callback );\n\tif ( webqit.realdom.attrInterceptionHooks?.intercepting ) return rm;\n\tconsole.warn( `Attr mutation APIs are now being intercepted.` );\n\twebqit.realdom.attrInterceptionHooks.intercepting = true;\n\tObject.defineProperty( webqit.realdom, 'attrInterceptionRecords', { value: new Map } );\n\n\t// Interception hooks\n\tconst attrIntercept = ( record, defaultAction ) => {\n\t\tif ( !webqit.realdom.attrInterceptionRecords.has( record.target ) ) { webqit.realdom.attrInterceptionRecords.set( record.target, {} ); }\n\t\tconst registry = webqit.realdom.attrInterceptionRecords.get( record.target );\n\t\t// ------------------\n\t\tclearTimeout( registry[ record.name ]?.timeout ); // Clear any previous that's still active\n\t\tregistry[ record.name ] = record.event; // Main: set event details... and next to timeout details\n\t\tconst timeout = setTimeout( () => { delete registry[ record.name ]; }, 0 );\n\t\tObject.defineProperty( record.event, 'timeout', { value: timeout, configurable: true } );\n\t\t// ------------------\n\t\twebqit.realdom.attrInterceptionHooks.get( 'intercept' )?.forEach( callback => callback( [ record ] ) );\n\t\tconst returnValue = defaultAction();\n\t\twebqit.realdom.attrInterceptionHooks.get( 'sync' )?.forEach( callback => callback( [ record ] ) );\n\t\treturn returnValue;\n\t};\n\n\t// Interception observer WILL need to know non-API-based mutations\n\tconst mo = new window.MutationObserver( records => {\n\t\trecords = dedup( records ).map( rcd => withAttrEventDetails.call( window, rcd ) ).filter( ( rcd, i ) => {\n\t\t\treturn !Array.isArray( rcd.event );\n\t\t} );\n\t\tif ( !records.length ) return;\n\t\twebqit.realdom.attrInterceptionHooks.get( 'intercept' )?.forEach( callback => callback( records ) );\n\t\twebqit.realdom.attrInterceptionHooks.get( 'sync' )?.forEach( callback => callback( records ) );\n\t} );\n\tmo.observe( document, { attributes: true, subtree: true, attributeOldValue: true } );\n\n\t// Intercept DOM attr mutation methods\n\tconst originalApis = Object.create( null );\n\t[ 'setAttribute', 'removeAttribute', 'toggleAttribute', ].forEach( apiName => {\n\t\toriginalApis[ apiName ] = Element.prototype[ apiName ];\n\t\tElement.prototype[ apiName ] = function( ...args ) {\n\t\t\tlet value, oldValue = this.getAttribute( args[ 0 ] );\n\t\t\tif ( [ 'setAttribute', 'toggleAttribute' ].includes( apiName ) ) { value = args[ 1 ]; }\n\t\t\tif ( apiName === 'toggleAttribute' && value === undefined ) {\n\t\t\t\tvalue = oldValue === null ? true : false;\n\t\t\t}\n\t\t\tconst record = { target: this, name: args[ 0 ], value, oldValue, type: 'interception', event: [ this, apiName ] };\n\t\t\tconst exec = () => originalApis[ apiName ].call( this, ...args );\n\t\t\treturn attrIntercept( record, exec );\n\t\t}\n\t} );\n\n\treturn rm;\n}\n", "\n/**\n * @imports\n */\nimport { _isObject } from '@webqit/util/js/index.js';\nimport { _from as _arrFrom } from '@webqit/util/arr/index.js';\nimport ATTRRealtime from './ATTRRealtime.js';\nimport Realtime from './Realtime.js';\n\n/**\n *\n * @class DOMRealtime\n */\nexport default class DOMRealtime extends Realtime {\n\n\t/**\n\t * @constructor\n\t */\n\tconstructor( context, ...args ) {\n\t\tsuper( context, 'tree', ...args );\n\t}\n\n\t/**\n\t * Alias for ( new ATTRRealtime() ).all( ... )\n\t */\n\tattr( filter, callback = undefined, params = {} ) {\n\t\tconst { context, window } = this;\n\t\treturn ( new ATTRRealtime( context, window ) ).get( ...arguments );\n\t}\n\n\t/**\n\t * Runs a query.\n\t *\n\t * @param array|Element|string\t\tselectors\n\t * @param function\t\t\t\t\tcallback\n\t * @param object\t\t\t\t\tparams\n\t *\n\t * @return Disconnectable|Void\n\t */\n\tquery( selectors, callback = undefined, params = {} ) {\n\t\t[ selectors, callback = undefined, params = {} ] = this.resolveArgs( arguments );\n\t\tconst { context } = this;\n\t\t// ------------------\n\t\tconst records = new Map, getRecord = target => {\n\t\t\tif ( !records.has( target ) ) { records.set( target, { target, entrants: [], exits: [], type: 'query', event: null } ); }\n\t\t\treturn records.get( target );\n\t\t};\n\t\t// ------------------\n\t\tif ( !params.generation || params.generation === 'entrants' ) {\n\t\t\tif ( !selectors.length ) {\n\t\t\t\t//if ( params.subtree ) throw new Error( `The subtree option requires a selector to work.` );\n\t\t\t\t[ ...context.children ].forEach( node => getRecord( context ).entrants.push( node ) );\n\t\t\t} else if ( selectors.every( selector => typeof selector === 'string' ) && ( selectors = selectors.join( ',' ) ) ) {\n\t\t\t\tconst matches = params.subtree\n\t\t\t\t\t? context.querySelectorAll( selectors )\n\t\t\t\t\t: [ ...context.children ].filter( node => node.matches( selectors ) );\n\t\t\t\tmatches.forEach( node => getRecord( node.parentNode || context ).entrants.push( node ) );\n\t\t\t}\n\t\t}\n\t\t// ------------------\n\t\tif ( !callback ) return records;\n\t\tconst disconnectable = { disconnected: false };\n\t\tconst signalGenerator = callback && params.lifecycleSignals && this.createSignalGenerator();\n\t\tfor ( const [ , record ] of records ) {\n\t\t\tif ( disconnectable.disconnected ) break;\n\t\t\tconst flags = signalGenerator?.generate() || {};\n\t\t\tcallback( record, flags, context );\n\t\t}\n\t\t// ------------------\n\t\tif ( params.live ) {\n\t\t\tif ( signalGenerator ) { params = { ...params, signalGenerator }; }\n\t\t\tconst disconnectable_live = this.observe( selectors, callback, params );\n\t\t\treturn this.disconnectables( params.signal, disconnectable, disconnectable_live );\n\t\t}\n\t\treturn this.disconnectables( params.signal, disconnectable, signalGenerator );\n\t}\n\n\t/**\n\t * Alias for query( ..., { subtree: false } )\n\t */\n\tchildren( selectors, callback = undefined, params = {} ) {\n\t\t[ selectors, callback = undefined, params = {} ] = this.resolveArgs( arguments );\n\t\treturn this.query( selectors, callback, { ...params, subtree: false } );\n\t}\n\n\t/**\n\t * Alias for query( ..., { subtree: true } )\n\t */\n\tsubtree( selectors, callback = undefined, params = {} ) {\n\t\t[ selectors, callback = undefined, params = {} ] = this.resolveArgs( arguments );\n\t\treturn this.query( selectors, callback, { ...params, subtree: true } );\n\t}\n\n\t/**\n\t * Mutation Observer\n\t * \n\t * @param array|Element|string\t\tselectors\n\t * @param function\t\t\t\t\tcallback\n\t * @param object\t\t\t\t\tparams\n\t * \n\t * @returns Disconnectable\n\t */\n\tobserve( selectors, callback, params = {} ) {\n\t\t[ selectors, callback, params = {} ] = this.resolveArgs( arguments );\n\t\t// ------------------------\n\t\tif ( [ 'sync', 'intercept' ].includes( params.timing ) ) return this.observeSync( selectors, callback, params );\n\t\tif ( params.timing && params.timing !== 'async' ) throw new Error( `Timing option \"${ params.timing }\" invalid.` );\n\t\t// ------------------------\n\t\tconst { context, window, webqit, document } = this;\n\t\t// ------------------\n\t\tif ( params.eventDetails ) { webqit.realdom.domInterceptionRecordsAlwaysOn = true; }\n\t\tif ( ( document.readyState === 'loading' || webqit.realdom.domInterceptionRecordsAlwaysOn ) && !webqit.realdom.domInterceptionHooks?.intercepting ) {\n\t\t\tdomInterception.call( window, 'sync', () => {} );\n\t\t}\n\t\t// -------------\n\t\tconst disconnectable = new window.MutationObserver( records => records.forEach( record => {\n\t\t\tdispatch.call( window, registration, withEventDetails.call( window, record ), context );\n\t\t} ) );\n\t\tdisconnectable.observe( context, { childList: true, subtree: params.subtree, } );\n\t\tconst signalGenerator = params.signalGenerator || params.lifecycleSignals && this.createSignalGenerator();\n\t\tconst registration = { context, selectors, callback, params, signalGenerator, disconnectable };\n\t\t// -------------\n\t\tif ( params.staticSensitivity ) {\n\t\t\tconst disconnectable_attr = staticSensitivity.call( window, registration );\n\t\t\treturn this.disconnectables( params.signal, disconnectable, signalGenerator, disconnectable_attr );\n\t\t}\n\t\treturn this.disconnectables( params.signal, disconnectable, signalGenerator );\n\t}\n\t\n\t/**\n\t * Mutation Interceptor\n\t * \n\t * @param array|Element|string\t\tselectors\n\t * @param function\t\t\t\t\tcallback\n\t * @param object\t\t\t\t\tparams\n\t * \n\t * @returns Disconnectable\n\t */\n\tobserveSync( selectors, callback, params = {} ) {\n\t\t[ selectors, callback, params = {} ] = this.resolveArgs( arguments );\n\t\tconst { context, window } = this;\n\t\t// -------------\n\t\tif ( params.timing && ![ 'sync', 'intercept' ].includes( params.timing ) ) throw new Error( `Timing option \"${ params.timing }\" invalid.` );\n\t\tconst interceptionTiming = params.timing === 'intercept' ? 'intercept' : 'sync';\n\t\tconst intersectionDepth = params.subtree ? 'subtree' : 'children';\n\t\tif ( !this.registry( interceptionTiming ).size ) {\n\t\t\t// One handler per intercept/sync registry\n\t\t\tdomInterception.call( window, interceptionTiming, record => {\n\t\t\t\tthis.forEachMatchingContext( interceptionTiming, record, dispatch );\n\t\t\t} );\n\t\t}\n\t\t// -------------\n\t\tconst disconnectable = { disconnect() {\n\t\t\tregistry.delete( registration );\n\t\t\tif ( !registry.size ) { registries.delete( context ); }\n\t\t} };\n\t\tconst signalGenerator = params.signalGenerator || params.lifecycleSignals && this.createSignalGenerator();\n\t\tconst registration = { context, selectors, callback, params, signalGenerator, disconnectable };\n\t\t// -------------\n\t\tconst registries = this.registry( interceptionTiming, intersectionDepth );\n\t\tif ( !registries.has( context ) ) { registries.set( context, new Set ); }\n\t\tconst registry = registries.get( context );\n\t\tregistry.add( registration );\n\t\t// -------------\n\t\tif ( params.staticSensitivity ) {\n\t\t\tconst disconnectable_attr = staticSensitivity.call( window, registration );\n\t\t\treturn this.disconnectables( params.signal, disconnectable, signalGenerator, disconnectable_attr );\n\t\t}\n\t\treturn this.disconnectables( params.signal, disconnectable, signalGenerator );\n\t}\n}\n\n/**\n * Sensitivty for attribute changes for attribute selectors.\n * \n * @param object registration\n * \n * @returns Disconnectable\n */\nfunction staticSensitivity( registration ) {\n\tconst window = this;\n\tconst { context, selectors, callback, params, signalGenerator } = registration;\n\tconst parseDot = selector => selector.match( /\\.([\\w-]+)/g )?.length ? [ 'class' ] : [];\n\tconst parseHash = selector => selector.match( /#([\\w-]+)/g )?.length ? [ 'id' ] : [];\n\tconst parse = selector => [ ...selector.matchAll(/\\[([^\\=\\]]+)(\\=[^\\]]+)?\\]/g) ].map( x => x[ 1 ] ).concat( parseDot( selector ) ).concat( parseHash( selector ) );\n\tif ( !( registration.$attrs = Array.from( new Set( selectors.filter( s => typeof s === 'string' && s.includes( '[' ) ).reduce( ( attrs, selector ) => attrs.concat( parse( selector ) ), [] ) ) ) ).length ) return;\n\t// ---------\n\tconst entrants = new Set, exits = new Set;\n\tentrants.push = val => ( exits.delete( val ), entrants.add( val ) );\n\texits.push = val => ( entrants.delete( val ), exits.add( val ) );\n\tregistration.$deliveryCache = { entrants, exits };\n\t// ---------\n\treturn ( new ATTRRealtime( context, window ) ).observe( registration.$attrs, _records => {\n\t\tconst records = new Map, getRecord = target => {\n\t\t\tif ( !records.has( target ) ) { records.set( target, { target, entrants: [], exits: [], type: 'static', event: null } ); }\n\t\t\treturn records.get( target );\n\t\t};\n\t\t// ---------\n\t\tconst matchesCache = new WeakMap;\n\t\tconst matches = node => {\n\t\t\tif ( !matchesCache.has( node ) ) { matchesCache.set( node, selectors.some( selector => node.matches( selector ) ) ); }\n\t\t\treturn matchesCache.get( node );\n\t\t};\n\t\t// ---------\n\t\tfor ( const _record of _records ) {\n\t\t\t[ 'entrants', 'exits' ].forEach( generation => {\n\t\t\t\tif ( params.generation && generation !== params.generation ) return;\n\t\t\t\tif ( registration.$deliveryCache[ generation ].has( _record.target ) || ( generation === 'entrants' ? !matches( _record.target ) : matches( _record.target ) ) ) return;\n\t\t\t\tregistration.$deliveryCache[ generation ].push( _record.target );\n\t\t\t\tgetRecord( _record.target )[ generation ].push( _record.target );\n\t\t\t\tgetRecord( _record.target ).event = _record.event;\n\t\t\t} );\n\t\t}\n\t\t// ---------\n\t\tfor ( const [ , record ] of records ) {\n\t\t\tconst flags = signalGenerator?.generate() || {};\n\t\t\tcallback( record, flags, context );\n\t\t}\n\t}, { subtree: params.subtree, timing: params.timing, eventDetails: params.eventDetails } );\n}\n\n/**\n * Dispatches a mutation record if it matches the observed.\n * \n * @param Object \t\t\tregistration \n * @param Object \t\t\trecord \n * \n * @returns Void\n */\nfunction dispatch( registration, _record ) {\n\tconst { context, selectors, callback, params, signalGenerator, $deliveryCache } = registration;\n\t// ---------\n\tconst record = { ..._record, entrants: [], exits: [] };\n\tif ( !params.eventDetails ) { delete record.event; }\n\t[ 'entrants', 'exits' ].forEach( generation => {\n\t\tif ( params.generation && generation !== params.generation ) return;\n\t\tif ( selectors.length ) {\n\t\t\trecord[ generation ] = nodesIntersection( selectors, _record[ generation ], _record.event !== 'parse' );\n\t\t} else {\n\t\t\trecord[ generation ] = [ ..._record[ generation ] ];\n\t\t}\n\t\tif ( !$deliveryCache ) return;\n\t\tfor ( const node of record[ generation ] ) {\n\t\t\t$deliveryCache[ generation ].push( node );\n\t\t}\n\t} );\n\t// ---------\n\tif ( !record.entrants.length && !record.exits.length ) return;\n\tconst flags = signalGenerator?.generate() || {};\n\tcallback( record, flags, context );\n}\n\n/**\n * Aggregates instances of els in sources\n * \n * @param Array \t\t\ttargets \n * @param Array \t\t\tsources \n * @param Bool \t\t\t\tdeepIntersect \n * \n * @returns \n */\nfunction nodesIntersection( targets, sources, deepIntersect ) {\n\tsources = Array.isArray( sources ) ? sources : [ ...sources ];\n\tconst match = ( sources, target ) => {\n\t\t// Filter out text nodes\n\t\tsources = sources.filter( source => source.matches );\n\t\tif ( typeof target === 'string' ) {\n\t\t\t// Is directly mutated...\n\t\t\tlet matches = sources.filter( source => source.matches( target ) );\n\t\t\t// Is contextly mutated...\n\t\t\tif ( deepIntersect ) {\n\t\t\t\tmatches = sources.reduce( ( collection, source ) => {\n\t\t\t\t\treturn [ ...collection, ...source.querySelectorAll( target ) ];\n\t\t\t\t}, matches );\n\t\t\t}\n\t\t\tif ( matches.length ) return matches;\n\t\t} else {\n\t\t\t// Is directly mutated...\n\t\t\tif ( sources.includes( target ) || (\n\t\t\t\tdeepIntersect && sources.some( source => source.contains( target ) )\n\t\t\t) ) { return [ target ]; }\n\t\t}\n\t};\n\t// Search can be expensive...\n\t// Multiple listeners searching the same thing in the same list?\n\tif ( !sources.$$searchCache ) { sources.$$searchCache = new Map; }\n\treturn targets.reduce( ( matches, target ) => {\n\t\tlet _matches;\n\t\tif ( sources.$$searchCache.has( target ) ) {\n\t\t\t_matches = sources.$$searchCache.get( target );\n\t\t} else {\n\t\t\t_matches = match( sources, target ) || [];\n\t\t\tif ( _isObject( target ) ) {\n\t\t\t\tsources.$$searchCache.set( target, _matches );\n\t\t\t}\n\t\t}\n\t\treturn matches.concat( _matches );\n\t}, [] );\n}\n\n/**\n * Determines the event for a mutation record\n * \n * @param MutationRecord \t{ target, entrants, exits }\n * \n * @returns Object\n */\nfunction withEventDetails( { target, addedNodes, removedNodes } ) {\n\tlet window = this, event;\n\tevent = _arrFrom( addedNodes ).reduce( ( prev, node ) => prev || window.webqit.realdom.domInterceptionRecords?.get( node ), null );\n\tevent = _arrFrom( removedNodes ).reduce( ( prev, node ) => prev || window.webqit.realdom.domInterceptionRecords?.get( node ), event );\n\tevent = event || window.document.readyState === 'loading' && 'parse' || 'mutation';\n\treturn { target, entrants: addedNodes, exits: removedNodes, type: 'observation', event };\n}\n\n/**\n * DOM intersection engine.\n * \n * @param String \t\t\ttiming \n * @param Function \t\t\tcallback \n * \n * @returns \n */\nfunction domInterception( timing, callback ) {\n\tconst window = this;\n\tconst { webqit, document, Node, Element, HTMLElement, HTMLTemplateElement, DocumentFragment } = window;\n\tif ( !webqit.realdom.domInterceptionHooks ) { Object.defineProperty( webqit.realdom, 'domInterceptionHooks', { value: new Map } ); }\n\tif ( !webqit.realdom.domInterceptionHooks.has( timing ) ) { webqit.realdom.domInterceptionHooks.set( timing, new Set ); }\n\twebqit.realdom.domInterceptionHooks.get( timing ).add( callback );\n\tconst rm = () => webqit.realdom.domInterceptionHooks.get( timing ).delete( callback );\n\tif ( webqit.realdom.domInterceptionHooks?.intercepting ) return rm;\n\tconsole.warn( `DOM mutation APIs are now being intercepted.` );\n\twebqit.realdom.domInterceptionHooks.intercepting = true;\n\tObject.defineProperty( webqit.realdom, 'domInterceptionRecords', { value: new Map } );\n\n\t// Interception hooks\n\tconst shouldObserve = () => true//document.readyState === 'loading' || webqit.realdom.domInterceptionRecordsAlwaysOn;\n\tconst intercept = ( record, defaultAction ) => {\n\t\tif ( shouldObserve() ) {\n\t\t\trecord.entrants.concat( record.exits ).forEach( node => {\n\t\t\t\tclearTimeout( webqit.realdom.domInterceptionRecords.get( node )?.timeout ); // Clear any previous that's still active\n\t\t\t\twebqit.realdom.domInterceptionRecords.set( node, record.event ); // Main: set event details... and next to timeout details\n\t\t\t\tconst timeout = setTimeout( () => { webqit.realdom.domInterceptionRecords.delete( node ); }, 0 );\n\t\t\t\tObject.defineProperty( record.event, 'timeout', { value: timeout, configurable: true } );\n\t\t\t} );\n\t\t} else { webqit.realdom.domInterceptionRecords.clear(); }\n\t\twebqit.realdom.domInterceptionHooks.get( 'intercept' )?.forEach( callback => callback( record ) );\n\t\tconst returnValue = defaultAction();\n\t\twebqit.realdom.domInterceptionHooks.get( 'sync' )?.forEach( callback => callback( record ) );\n\t\treturn returnValue;\n\t};\n\n\t// Interception observer WILL need to know non-API-based mutations\n\tif ( shouldObserve() ) {\n\t\tconst mo = new window.MutationObserver( records => records.forEach( record => {\n\t\t\tif ( Array.isArray( ( record = withEventDetails.call( window, record ) ).event ) ) return;\n\t\t\twebqit.realdom.domInterceptionHooks.get( 'intercept' )?.forEach( callback => callback( record ) );\n\t\t\twebqit.realdom.domInterceptionHooks.get( 'sync' )?.forEach( callback => callback( record ) );\n\t\t} ) );\n\t\tmo.observe( document, { childList: true, subtree: true, } );\n\t\tdocument.addEventListener( 'readystatechange', () => !shouldObserve() && mo.disconnect() );\n\t}\n\n\t// Intercept DOM mutation methods\n\tconst originalApis = Object.create( null );\n\t[ 'insertBefore'/*Node*/, 'insertAdjacentElement', 'insertAdjacentHTML', 'setHTML',\n\t\t'replaceChildren', 'replaceWith', 'remove', 'replaceChild'/*Node*/, 'removeChild'/*Node*/, \n\t\t'before', 'after', 'append', 'prepend', 'appendChild'/*Node*/, \n\t].forEach( apiName => {\n\t\t// We'll be sure to monkey the correct interface\n\t\tconst Interface = [ 'insertBefore', 'replaceChild', 'removeChild', 'appendChild' ].includes( apiName ) ? Node : Element;\n\t\toriginalApis[ apiName ] = Interface.prototype[ apiName ];\n\t\t// In case newer methods like setHTML() are not supported\n\t\tif ( !originalApis[ apiName ] ) return;\n\t\t// Monkey now...\n\t\tInterface.prototype[ apiName ] = function( ...args ) {\n\t\t\t// Instance of Node interface? Abort!\n\t\t\tconst exec = () => originalApis[ apiName ].call( this, ...args );\n\t\t\tif ( !( this instanceof Element || this instanceof DocumentFragment ) ) return exec();\n\t\t\t// --------------\n\t\t\t// Obtain exits and entrants\n\t\t\tlet exits = [], entrants = [], target = this;\n\t\t\tif ( [ 'insertBefore' ].includes( apiName ) ) {\n\t\t\t\tentrants = [ args[ 0 ] ];\n\t\t\t} else if ( [ 'insertAdjacentElement', 'insertAdjacentHTML' ].includes( apiName ) ) {\n\t\t\t\tentrants = [ args[ 1 ] ];\n\t\t\t\tif ( [ 'beforebegin', 'afterend' ].includes( args[ 0 ] ) ) {\n\t\t\t\t\ttarget = this.parentNode;\n\t\t\t\t}\n\t\t\t} else if ( [ 'setHTML', 'replaceChildren' ].includes( apiName ) ) {\n\t\t\t\texits = [ ...this.childNodes ];\n\t\t\t\tentrants = apiName === 'replaceChildren' ? [ ...args ] : [ args[ 0 ] ];\n\t\t\t} else if ( [ 'replaceWith', 'remove' ].includes( apiName ) ) {\n\t\t\t\texits = [ this ];\n\t\t\t\tentrants = apiName === 'replaceWith' ? [ ...args ] : [];\n\t\t\t\ttarget = this.parentNode;\n\t\t\t} else if ( [ 'replaceChild' ].includes( apiName ) ) {\n\t\t\t\texits = [ args[ 1 ] ];\n\t\t\t\tentrants = [ args[ 0 ] ];\n\t\t\t} else if ( [ 'removeChild' ].includes( apiName ) ) {\n\t\t\t\texits = [ ...args ];\n\t\t\t} else {\n\t\t\t\t// 'before', 'after', 'append', 'prepend', 'appendChild'\n\t\t\t\tentrants = [ ...args ];\n\t\t\t\tif ( [ 'before', 'after' ].includes( apiName ) ) {\n\t\t\t\t\ttarget = this.parentNode;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// --------------\n\t\t\t// Parse HTML to entrants\n\t\t\tlet apiNameFinal = apiName;\n\t\t\tif ( [ 'insertAdjacentHTML', 'setHTML' ].includes( apiName ) ) {\n\t\t\t\tlet tempNodeName = this.nodeName;\n\t\t\t\tif ( apiName === 'insertAdjacentHTML' && [ 'beforebegin', 'afterend' ].includes( args[ 0 ] ) ) {\n\t\t\t\t\t// We can't handle this... and this is going to throw afterall\n\t\t\t\t\tif ( !this.parentNode ) return originalApis[ apiName ].call( this, ...args );\n\t\t\t\t\ttempNodeName = this.parentNode.nodeName;\n\t\t\t\t}\n\t\t\t\tconst temp = document.createElement( tempNodeName );\n\t\t\t\toriginalApis.setHTML.call( temp, entrants[ 0 ], apiName === 'setHTML' ? args[ 1 ] : {} );\n\t\t\t\tentrants = [ ...temp.childNodes ];\n\t\t\t\t// --------------  \n\t\t\t\tif ( apiName === 'insertAdjacentHTML' ) {\n\t\t\t\t\tapiNameFinal = 'insertAdjacentElement';\n\t\t\t\t\targs[ 1 ] = new DocumentFragment;\n\t\t\t\t\targs[ 1 ].______isTemp = true;\n\t\t\t\t\targs[ 1 ].append( ...temp.childNodes );\n\t\t\t\t} else {\n\t\t\t\t\tapiNameFinal = 'replaceChildren';\n\t\t\t\t\targs = [ ...temp.childNodes ];\n\t\t\t\t}\n\t\t\t}\n\t\t\t// --------------\n\t\t\tconst record = { target, entrants, exits, type: 'interception', event: [ this, apiName ] };\n\t\t\treturn intercept( record, () => {\n\t\t\t\treturn originalApis[ apiNameFinal ].call( this, ...args );\n\t\t\t} );\n\t\t}\n\t} );\n\n\t// Intercept DOM mutation properties\n\t[ 'outerHTML', 'outerText'/*HTMLElement*/, 'innerHTML', \n\t\t'innerText'/*HTMLElement*/,'textContent'/*Node*/, 'nodeValue'/*Node*/\n\t].forEach( apiName => {\n\t\t// We'll be sure to monkey the correct interface\n\t\tconst Interface = [ 'textContent', 'nodeValue' ].includes( apiName ) ? Node : (\n\t\t\t[ 'outerText', 'innerText' ].includes( apiName ) ? HTMLElement : Element\n\t\t);\n\t\toriginalApis[ apiName ] = Object.getOwnPropertyDescriptor( Interface.prototype, apiName );\n\t\tObject.defineProperty( Interface.prototype, apiName, { ...originalApis[ apiName ], set: function( value ) {\n\t\t\tlet exec = () => originalApis[ apiName ].set.call( this, value );\n\t\t\t// Instance of Node interface? Abort!\n\t\t\tif ( !( this instanceof Element ) ) return exec();\n\t\t\t// --------------\n\t\t\t// Obtain exits and entrants\n\t\t\tlet exits = [], entrants = [], target = this;\n\t\t\tif ( [ 'outerHTML', 'outerText' ].includes( apiName ) ) {\n\t\t\t\texits = [ this ];\n\t\t\t\ttarget = this.parentNode;\n\t\t\t} else {\n\t\t\t\t// 'innerHTML', 'innerText', 'textContent', 'nodeValue'\n\t\t\t\texits = /*this instanceof HTMLTemplateElement \n\t\t\t\t\t? [ ...this.content.childNodes ]\n\t\t\t\t\t: */[ ...this.childNodes ];\n\t\t\t}\n\t\t\t// --------------\n\t\t\t// Parse HTML to nodes\n\t\t\tif ( [ 'outerHTML', 'innerHTML' ].includes( apiName ) ) {\n\t\t\t\tlet tempNodeName = this.nodeName;\n\t\t\t\tif ( apiName === 'outerHTML' ) {\n\t\t\t\t\t// We can't handle this... and this is going to throw afterall\n\t\t\t\t\tif ( !this.parentNode ) return exec();\n\t\t\t\t\ttempNodeName = this.parentNode.nodeName;\n\t\t\t\t}\n\t\t\t\tconst temp = document.createElement( tempNodeName === 'TEMPLATE' ? 'div' : tempNodeName );\n\t\t\t\toriginalApis[ apiName ].set.call( temp, value );\n\t\t\t\tentrants = /*[ ...temp.childNodes ];*/this instanceof HTMLTemplateElement ? [] : [ ...temp.childNodes ];\n\t\t\t\t// -------------- \n\t\t\t\tif ( apiName === 'outerHTML' ) {\n\t\t\t\t\tvalue = new DocumentFragment;\n\t\t\t\t\tvalue.______isTemp = true;\n\t\t\t\t\tvalue.append( ...temp.childNodes );\n\t\t\t\t\texec = () => originalApis.replaceWith.call( this, value );\n\t\t\t\t} else {\n\t\t\t\t\tif ( this instanceof HTMLTemplateElement ) {\n\t\t\t\t\t\texec = () => this.content.replaceChildren( ...temp.childNodes );\n\t\t\t\t\t} else {\n\t\t\t\t\t\texec = () => originalApis.replaceChildren.call( this, ...temp.childNodes );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// -------------- \n\t\t\tconst record = { target, entrants, exits, type: 'interception', event: [ this, apiName ] };\n\t\t\treturn intercept( record, exec );\n\t\t} } );\n\t} );\n\n\t// Intercept document mutation methods\n\t[ 'append', 'prepend', 'replaceChildren' ].forEach( apiName => {\n\t\t[ document, DocumentFragment.prototype ].forEach( target => {\n\t\t\tconst originalApi = target[ apiName ];\n\t\t\ttarget[ apiName ] = function( ...args ) {\n\t\t\t\tif ( this.______isTemp ) return originalApi.call( this, ...args );\n\t\t\t\tconst exits = apiName === 'replaceChildren' ? [ ...this.childNodes ] : [];\n\t\t\t\tconst record = {\n\t\t\t\t\ttarget: this,\n\t\t\t\t\tentrants: args,\n\t\t\t\t\texits,\n\t\t\t\t\ttype: 'interception', \n\t\t\t\t\tevent: [ this, apiName ]\n\t\t\t\t};\n\t\t\t\treturn intercept( record, () => {\n\t\t\t\t\treturn originalApi.call( this, ...args );\n\t\t\t\t} );\n\t\t\t}\n\t\t} );\n\t} );\n\n\treturn rm;\n}\n", "\r\n/**\r\n * Applies all supported polyfills\r\n */\r\nexport default function() {\r\n    CSS_escape.call( this );\r\n    Node_isConnected.call( this );\r\n    Element_matches.call( this );\r\n}\r\n\r\n/**\r\n * Polyfills the window.CSS object.\r\n *  \r\n * @return void\r\n */\r\nexport function CSS_escape() {\r\n    const window = this;\r\n    if ( !window.CSS ) { window.CSS = {} }\r\n    if ( !window.CSS.escape ) {\r\n        /**\r\n         * Polyfills the window.CSS.escape() function.\r\n         *  \r\n         * @param string str \r\n         * \r\n         * @return string\r\n         */\r\n        window.CSS.escape = str => str.replace( /([\\:@\\~\\$\\&])/g, '\\\\$1' );\r\n    }\r\n}\r\n\r\n/**\r\n * Polyfills the Node.prototype.isConnected property\r\n * \r\n * @see MDN\r\n  *  \r\n * @return bool\r\n*/\r\nexport function Node_isConnected() {\r\n    const window = this;\r\n    if ( !( 'isConnected' in window.Node.prototype ) ) {\r\n        Object.defineProperty( window.Node.prototype, 'isConnected', { get: function() {\r\n            return !this.ownerDocument || !(\r\n                this.ownerDocument.compareDocumentPosition( this )\r\n                & this.DOCUMENT_POSITION_DISCONNECTED);\r\n        } } );\r\n    }\r\n}\r\n\r\n/**\r\n * Polyfills the Element.prototype.matches() method\r\n * \r\n * @see MDN\r\n  *  \r\n * @return void\r\n*/\r\nexport function Element_matches() {\r\n    const window = this;\r\n    if ( !window.Element.prototype.matches ) {\r\n        window.Element.prototype.matches = \r\n        window.Element.prototype.matchesSelector || \r\n        window.Element.prototype.mozMatchesSelector ||\r\n        window.Element.prototype.msMatchesSelector || \r\n        window.Element.prototype.oMatchesSelector || \r\n        window.Element.prototype.webkitMatchesSelector ||\r\n        function( s ) {\r\n            var matches = ( this.document || this.ownerDocument ).querySelectorAll( s ),\r\n                i = matches.length;\r\n            while ( --i >= 0 && matches.item( i ) !== this ) {}\r\n            return i > -1;            \r\n        }\r\n    }\r\n}", "\r\n/**\r\n * @imports\r\n */\r\nimport { _isNumeric, _isString, _isFunction } from '@webqit/util/js/index.js';\r\nimport { _set } from '@webqit/util/obj/index.js';\r\nimport Scheduler from './Scheduler.js';\r\nimport DOMRealtime from './realtime/DOMRealtime.js';\r\nimport ATTRRealtime from './realtime/ATTRRealtime.js';\r\nimport polyfill from './polyfills.js';\r\n\r\nexport default function() {\r\n    const window = this;\r\n    if ( !window.webqit ) window.webqit = {};\r\n    if ( window.webqit.realdom ) return window.webqit.realdom;\r\n    window.webqit.realdom = {};\r\n    polyfill.call( window );\r\n    // ------\r\n    window.webqit.realdom.meta = ( ...args ) => meta.call( window, ...args );\r\n    window.webqit.realdom.ready = ( ...args ) => ready.call( window, ...args );\r\n    // ------\r\n    window.webqit.realdom.realtime = ( context, namespace = 'dom' ) => {\r\n        if ( namespace === 'dom' ) return new DOMRealtime( context, window );\r\n        if ( namespace === 'attr' ) return new ATTRRealtime( context, window );\r\n    };\r\n    // ------\r\n    const scheduler = new Scheduler( window );\r\n    window.webqit.realdom.schedule = ( type, ...args ) => {\r\n        return scheduler[ `on${ type }` ]( ...args );\r\n    };\r\n    // ------\r\n    return window.webqit.realdom;\r\n}\r\n\r\n\r\n/**\r\n * DOM-ready listeners.\r\n * \r\n * @param Function\t    \t\tcallback\r\n * \r\n * @return void\r\n */\r\nfunction ready( ...args ) {\r\n    let timing = 'interactive', callback;\r\n    if ( _isString( args[ 0 ] ) ) {\r\n        timing = args[ 0 ];\r\n        if ( _isFunction( args[ 1 ] ) ) { callback = args[ 1 ]; }\r\n    } else if ( _isFunction( args[ 0 ] ) ) { callback = args[ 0 ]; }\r\n    // --------------\r\n    const timings = { interactive: [ 'interactive', 'complete' ], complete: [ 'complete' ], };\r\n    if ( !timings[ timing ] ) throw new Error( `Invalid ready-state timing: ${ timing }.` );\r\n\tconst window = this;\r\n    // --------------\r\n    if ( !callback ) {\r\n        if ( !window.webqit.realdom.readyStatePromises ) {\r\n            window.webqit.realdom.readyStatePromises = {\r\n                interactive: new Promise( res => ready.call( this, 'interactive', res ) ),\r\n                complete: new Promise( res => ready.call( this, 'complete', res ) ),\r\n            };\r\n        }\r\n        return window.webqit.realdom.readyStatePromises[ timing ];\r\n    }\r\n    // --------------\r\n\tif ( timings[ timing ].includes( window.document.readyState ) ) return callback( window );\r\n    if ( !window.webqit.realdom.readyStateCallbacks ) {\r\n        window.webqit.realdom.readyStateCallbacks = { interactive: [], complete: [] };\r\n        window.document.addEventListener( 'readystatechange', () => {\r\n            const state = window.document.readyState;\r\n            for ( const callback of window.webqit.realdom.readyStateCallbacks[ state ].splice( 0 ) ) {\r\n                callback( window );\r\n            }\r\n        }, false );\r\n    }\r\n    window.webqit.realdom.readyStateCallbacks[ timing ].push( callback );\r\n}\r\n\r\n/**\r\n * A webqit's meta tag props reader.\r\n *  \r\n * @param String name\r\n * \r\n * @return Object\r\n */\r\nfunction meta( name ) {\r\n    const window = this;\r\n    let _content = {}, _el;\r\n    if ( _el = window.document.querySelector( `meta[name=\"${ name }\"]` ) ) {\r\n        _content = ( _el.content || '' ).split( ';' ).filter( v => v ).reduce( ( _metaVars, directive ) => {\r\n            const directiveSplit = directive.split( '=' ).map( d => d.trim() );\r\n            _set( _metaVars, directiveSplit[ 0 ].split( '.' ), directiveSplit[ 1 ] === 'true' ? true : (directiveSplit[ 1 ] === 'false' ? false : (\r\n                    _isNumeric( directiveSplit[ 1 ] ) ? parseInt( directiveSplit[ 1 ] ) : directiveSplit[ 1 ]\r\n                ) )\r\n            );\r\n            return _metaVars;\r\n        }, {} );\r\n    }\r\n    return { get name() { return name; }, get content() { return _el.content; }, json() {\r\n\t\treturn JSON.parse( JSON.stringify( _content ) );\r\n    } };\r\n}", "\n/**\n * @imports\n */\nimport init from './index.js';\n\ninit.call( window );"],
  "mappings": "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",
  "names": ["isObject_default", "val", "isArray_default", "val", "intersect_default", "arr", "arr2", "callback", "isArray_default", "val1", "val2", "internals", "obj", "namespaces", "ObservableMap", "itnls", "_ns", "_itnls", "args", "key", "value", "returnValue", "type", "callback", "entry", "_intersection", "a", "b", "intersect_default", "isTypeFunction_default", "val", "isNull_default", "val", "isUndefined_default", "val", "isTypeObject_default", "val", "isTypeFunction_default", "isEmpty_default", "val", "isNull_default", "isUndefined_default", "isTypeObject_default", "isFunction_default", "val", "isTypeFunction_default", "isNumber_default", "val", "isNumeric_default", "val", "isNumber_default", "isString_default", "val", "isTypeArray_default", "val", "isString_default", "isUndefined_default", "from_default", "val", "castObject", "isArray_default", "isObject_default", "isEmpty_default", "isTypeArray_default", "get_default", "ctxt", "path", "trap", "reciever", "from_default", "_ctxt", "isUndefined_default", "isNull_default", "_key", "isTypeObject_default", "set_default", "obj", "path", "val", "buildTree", "trap", "_set", "target", "key", "isNumeric_default", "i", "isArray_default", "from_default", "isTypeObject_default", "isFunction_default", "branch", "get_default", "branchSuccess", "Scheduler", "window", "asyncDOM", "callback", "withPromise", "resolve", "onread", "onwrite", "prevTransaction", "readReturn", "callWrite", "writeReturn", "repeatTransaction", "Realtime", "context", "namespace", "window", "args", "isFunction_default", "isObject_default", "from_default", "internals", "interceptionTiming", "record_s", "callback", "records", "dispatchBatch", "depth", "registries", "registry", "matches", "record", "registration", "signal", "objects", "disconnectable", "d", "AttrRealtime", "Realtime", "context", "args", "filter", "callback", "params", "originalFilterIsString", "records", "attrIntersection", "record_s", "signalGenerator", "flags", "disconnectable_live", "window", "webqit", "attrInterception", "disconnectable", "dedup", "rcd", "withAttrEventDetails", "dispatch", "registration", "$params", "interceptionTiming", "intersectionDepth", "registry", "registries", "rcds", "i", "atomics", "exclusion", "record", "value", "_type", "attrName", "r", "attr", "target", "attributeName", "oldValue", "event", "timing", "document", "Element", "rm", "attrIntercept", "defaultAction", "timeout", "returnValue", "originalApis", "apiName", "DOMRealtime", "Realtime", "context", "args", "filter", "callback", "params", "window", "AttrRealtime", "selectors", "records", "getRecord", "target", "selector", "node", "disconnectable", "signalGenerator", "record", "flags", "disconnectable_live", "webqit", "document", "domInterception", "dispatch", "registration", "withEventDetails", "disconnectable_attr", "staticSensitivity", "interceptionTiming", "intersectionDepth", "registry", "registries", "parseDot", "parseHash", "parse", "x", "s", "attrs", "entrants", "exits", "val", "_records", "matchesCache", "matches", "_record", "generation", "$deliveryCache", "nodesIntersection", "targets", "sources", "deepIntersect", "match", "source", "collection", "_matches", "isObject_default", "addedNodes", "removedNodes", "event", "from_default", "prev", "timing", "Node", "Element", "HTMLElement", "HTMLTemplateElement", "DocumentFragment", "rm", "shouldObserve", "intercept", "defaultAction", "timeout", "returnValue", "mo", "originalApis", "apiName", "Interface", "exec", "apiNameFinal", "tempNodeName", "temp", "value", "originalApi", "polyfills_default", "CSS_escape", "Node_isConnected", "Element_matches", "window", "str", "s", "matches", "i", "src_default", "window", "polyfills_default", "args", "meta", "ready", "context", "namespace", "DOMRealtime", "AttrRealtime", "scheduler", "Scheduler", "type", "timing", "callback", "isString_default", "isFunction_default", "timings", "res", "state", "name", "_content", "_el", "v", "_metaVars", "directive", "directiveSplit", "d", "set_default", "isNumeric_default", "src_default"]
}
